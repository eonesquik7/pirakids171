<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Pirakids - Gerador e Verificador</title>
<style>
  /* Tema vermelho, preto e branco */
  body {
    background-color: #000;
    color: #fff;
    font-family: monospace, monospace;
    margin: 20px;
  }
  h2 {
    color: #f00;
    margin-bottom: 10px;
    text-align: center;
  }
  .container {
    display: flex;
    gap: 20px;
    flex-wrap: wrap;
    justify-content: center;
  }
  .box {
    background: #111;
    border: 2px solid #f00;
    border-radius: 8px;
    padding: 15px;
    width: 400px;
    box-sizing: border-box;
    display: flex;
    flex-direction: column;
  }
  label {
    margin-top: 10px;
  }
  input[type="number"],
  input[type="text"],
  select,
  textarea {
    margin-top: 5px;
    background: #222;
    border: 1px solid #f00;
    color: #fff;
    padding: 6px;
    font-family: monospace, monospace;
    font-size: 14px;
    border-radius: 4px;
    resize: none;
  }
  input[type="number"],
  input[type="text"] {
    width: 100%;
  }
  textarea {
    width: 100%;
    height: 150px;
    font-size: 13px;
  }
  button {
    margin-top: 15px;
    padding: 10px;
    background: #f00;
    border: none;
    color: #fff;
    font-weight: bold;
    cursor: pointer;
    border-radius: 5px;
    font-family: monospace, monospace;
    font-size: 14px;
    transition: background-color 0.3s ease;
  }
  button:hover {
    background: #c00;
  }
  .result {
    margin-top: 15px;
    background: #222;
    border: 1px solid #f00;
    padding: 10px;
    height: 150px;
    overflow-y: auto;
    white-space: pre-wrap;
    font-size: 14px;
  }
  .btn-group {
    display: flex;
    gap: 10px;
    margin-top: 10px;
  }
</style>
</head>
<body>

<div class="container">
  <!-- Gerador -->
  <div class="box" id="generator-box">
    <h2>Gerador de Cartões</h2>

    <label for="select-brand">Selecione a bandeira:</label>
    <select id="select-brand">
      <option value="random">Aleatório</option>
      <option value="visa">Visa</option>
      <option value="mastercard">MasterCard</option>
      <option value="amex">American Express</option>
      <option value="discover">Discover</option>
      <option value="diners">Diners Club</option>
      <option value="jcb">JCB</option>
      <option value="elo">Elo</option>
      <option value="hiper">Hiper</option>
      <option value="hipercard">Hipercard</option>
    </select>

    <label for="input-quantity">Quantidade:</label>
    <input type="number" id="input-quantity" min="1" value="5" />

    <button id="btn-generate">Gerar Cartões</button>

    <div class="btn-group">
      <button id="btn-copy">Copiar</button>
      <button id="btn-export">Exportar TXT</button>
    </div>

    <pre class="result" id="generate-result"></pre>
  </div>

  <!-- Verificador Único -->
  <div class="box" id="checker-box">
    <h2>Verificador de Cartão Único</h2>

    <label for="single-number">Número do cartão:</label>
    <input type="text" id="single-number" placeholder="Número (somente dígitos)" />

    <label for="single-validity">Validade (MM/AA):</label>
    <input type="text" id="single-validity" placeholder="Ex: 12/25" maxlength="5" />

    <label for="single-cvv">CVV:</label>
    <input type="text" id="single-cvv" placeholder="CVV" />

    <button id="btn-check">Verificar</button>

    <pre class="result" id="single-check-result"></pre>
  </div>
</div>

<script>
  // Função Luhn para validar número do cartão
  function isValidLuhn(num) {
    let sum = 0, alt = false;
    for (let i = num.length - 1; i >= 0; i--) {
      let n = parseInt(num.charAt(i), 10);
      if (alt) {
        n *= 2;
        if (n > 9) n -= 9;
      }
      sum += n;
      alt = !alt;
    }
    return (sum % 10 === 0);
  }

  // Validar data validade MM/AA
  function isValidDate(str) {
    if (!/^\d{2}\/\d{2}$/.test(str)) return false;
    const [mm, aa] = str.split('/').map(x => parseInt(x, 10));
    if (mm < 1 || mm > 12) return false;
    const currentYear = new Date().getFullYear() % 100;
    return aa >= currentYear;
  }

  // Detecta bandeira por prefixo e tamanho
  function getBrandByNumber(num) {
    const len = num.length;
    if (/^4/.test(num) && (len === 13 || len === 16 || len === 19)) return 'Visa';
    if (/^5[1-5]/.test(num) && len === 16) return 'MasterCard';
    if (/^3[47]/.test(num) && len === 15) return 'American Express';
    if (/^6(?:011|5)/.test(num) && len === 16) return 'Discover';
    if (/^3(?:0[0-5]|[68])/.test(num) && len === 14) return 'Diners Club';
    if (/^(?:2131|1800|35)/.test(num) && (len === 15 || len === 16)) return 'JCB';
    if (/^4011(78|79)/.test(num)) return 'Elo';
    if (/^(3841|60)/.test(num)) return 'Hiper';
    if (/^606282/.test(num)) return 'Hipercard';
    return 'Desconhecida';
  }

  // Gerar cartão válido para cada bandeira
  function generateCard(brand) {
    let prefix = '';
    let length = 16;

    switch(brand) {
      case 'visa': prefix = '4'; length = 16; break;
      case 'mastercard': prefix = '5' + (Math.floor(Math.random()*5)+1); length = 16; break;
      case 'amex': prefix = (Math.random() < 0.5) ? '34' : '37'; length = 15; break;
      case 'discover': prefix = '6011'; length = 16; break;
      case 'diners': prefix = '36'; length = 14; break;
      case 'jcb': prefix = '35'; length = 16; break;
      case 'elo': prefix = '4011'; length = 16; break;
      case 'hiper': prefix = '3841'; length = 16; break;
      case 'hipercard': prefix = '606282'; length = 16; break;
      default:
        if (Math.random() < 0.5) {
          prefix = '4'; length = 16;
        } else {
          prefix = '5' + (Math.floor(Math.random()*5)+1); length = 16;
        }
    }

    let number = prefix;
    while (number.length < length - 1) {
      number += Math.floor(Math.random() * 10);
    }

    // Calcular dígito verificador (Luhn)
    function calcCheckDigit(num) {
      let sum = 0;
      let alt = true;
      for (let i = num.length - 1; i >= 0; i--) {
        let n = parseInt(num.charAt(i), 10);
        if (alt) {
          n *= 2;
          if (n > 9) n -= 9;
        }
        sum += n;
        alt = !alt;
      }
      return (10 - (sum % 10)) % 10;
    }

    const checkDigit = calcCheckDigit(number);
    number += checkDigit;

    // Gerar validade (futuro, tema vermelho/preto)
    const now = new Date();
    const month = String(Math.floor(Math.random() * 12) + 1).padStart(2, '0');
    const year = String(now.getFullYear() + Math.floor(Math.random() * 5) + 1).slice(2);

    // Gerar CVV
    const cvvLength = (brand === 'amex') ? 4 : 3;
    let cvv = '';
    for (let i=0; i<cvvLength; i++) cvv += Math.floor(Math.random() * 10);

    return `${number}|${month}/${year}|${cvv}`;
  }

  // Botões e inputs
  const btnGenerate = document.getElementById('btn-generate');
  const resultArea = document.getElementById('generate-result');
  const selectBrand = document.getElementById('select-brand');
  const inputQuantity = document.getElementById('input-quantity');
  const btnCopy = document.getElementById('btn-copy');
  const btnExport = document.getElementById('btn-export');

  btnGenerate.addEventListener('click', () => {
    const brand = selectBrand.value;
    let qty = parseInt(inputQuantity.value);
    if (isNaN(qty) || qty < 1) qty = 1;

    let cards = [];
    for (let i=0; i < qty; i++) {
      if (brand === 'random') {
        const brands = ['visa','mastercard','amex','discover','diners','jcb','elo','hiper','hipercard'];
        cards.push(generateCard(brands[Math.floor(Math.random()*brands.length)]));
      } else {
        cards.push(generateCard(brand));
      }
    }

    resultArea.textContent = cards.join('\n');
  });

  btnCopy.addEventListener('click', () => {
    if (!resultArea.textContent) return alert('Nada para copiar!');
    navigator.clipboard.writeText(resultArea.textContent)
      .then(() => alert('Copiado para a área de transferência!'))
      .catch(() => alert('Falha ao copiar.'));
  });

  btnExport.addEventListener('click', () => {
    if (!resultArea.textContent) return alert('Nada para exportar!');
    const blob = new Blob([resultArea.textContent], {type: 'text/plain'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'cartoes.txt';
    a.click();
    URL.revokeObjectURL(url);
  });

  // Verificador único
  const btnCheck = document.getElementById('btn-check');
  const singleNumber = document.getElementById('single-number');
  const singleValidity = document.getElementById('single-validity');
  const singleCVV = document.getElementById('single-cvv');
  const singleCheckResult = document.getElementById('single-check-result');

  btnCheck.addEventListener('click', () => {
    const num = singleNumber.value.trim();
    const val = singleValidity.value.trim();
    const cvv = singleCVV.value.trim();

    if (!/^\d+$/.test(num)) {
      singleCheckResult.textContent = 'Número inválido: deve conter somente dígitos.';
      return;
    }
    if (!isValidLuhn(num)) {
      singleCheckResult.textContent = 'Número inválido segundo Luhn.';
      return;
    }
    if (!isValidDate(val)) {
      singleCheckResult.textContent = 'Validade inválida ou expirada.';
      return;
    }
    if (!/^\d{3,4}$/.test(cvv)) {
      singleCheckResult.textContent = 'CVV inválido.';
      return;
    }

    const brand = getBrandByNumber(num);

    singleCheckResult.innerHTML =
      `Número: ${num}\n` +
      `Bandeira detectada: ${brand}\n` +
      `Validade: %c${val}%c\n` +
      `CVV: ${cvv}\n` +
      `Status: %cVálido%c`;

    // Como innerHTML não suporta styling para texto puro, usar styling via console:
    // Como alternativa simples, só colocamos cores em todo texto:
    // Aqui colocamos a validade com fundo vermelho e texto branco, para destacar

    // Para destacar visualmente a validade no resultado, vamos colocar o resultado com linhas coloridas:
    // Como não podemos usar style no <pre> facilmente, vamos usar spans e innerHTML com escapes:

    singleCheckResult.innerHTML = `
      Número: ${num}<br>
      Bandeira detectada: ${brand}<br>
      Validade: <span style="background-color:#f00; color:#fff; padding:2px 5px; border-radius:3px;">${val}</span><br>
      CVV: ${cvv}<br>
      Status: <span style="color:#0f0; font-weight:bold;">Válido</span>
    `;
  });
</script>

</body>
</html>

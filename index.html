<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Filtrar por Estado SC</title>
  <style>
    body {
      background: #111;
      color: #eee;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    input, .output, button {
      margin-top: 15px;
      padding: 10px;
      background: #222;
      color: #eee;
      border: none;
      border-radius: 6px;
      width: 100%;
      font-size: 15px;
    }
    .output {
      white-space: pre-wrap;
      min-height: 200px;
    }
    button {
      cursor: pointer;
      background: #333;
    }
    button:hover {
      background: #444;
    }
  </style>
</head>
<body>

<h2>Filtrar Linhas do Estado de Santa Catarina (SC)</h2>

<input type="file" accept=".txt" multiple onchange="lerArquivos(event)" />
<div class="output" id="resultado"></div>
<button id="baixarBtn" onclick="baixarTXT()" style="display:none;">Baixar Resultado (.txt)</button>

<script>
let conteudoFinal = "";

function ehEnderecoDeSC(linha) {
  // Considera SC apenas se estiver claramente no final como UF (ex: "- SC" ou "/SC" no final da parte do endereço)
  const partes = linha.split("-");
  const ultimaParte = partes[partes.length - 1] || "";
  return /\bSC\b/.test(ultimaParte.trim());
}

function lerArquivos(event) {
  const arquivos = Array.from(event.target.files);
  const resultadosSC = [];
  let lidos = 0;

  if (arquivos.length === 0) {
    document.getElementById("resultado").textContent = "Nenhum arquivo selecionado.";
    return;
  }

  arquivos.forEach(arquivo => {
    const leitor = new FileReader();
    leitor.onload = function(e) {
      const linhas = e.target.result.split('\n');
      const sc = linhas.filter(l => ehEnderecoDeSC(l));
      resultadosSC.push(...sc);
      lidos++;

      if (lidos === arquivos.length) {
        const unicos = [...new Set(resultadosSC)];
        conteudoFinal = unicos.join('\n');
        document.getElementById("resultado").textContent = conteudoFinal || "Nenhuma linha com endereço de SC encontrada.";
        document.getElementById("baixarBtn").style.display = conteudoFinal ? 'block' : 'none';
      }
    };
    leitor.readAsText(arquivo);
  });
}

function baixarTXT() {
  const blob = new Blob([conteudoFinal], { type: "text/plain;charset=utf-8" });
  const link = document.createElement("a");
  link.href = URL.createObjectURL(blob);
  link.download = "enderecos_SC.txt";
  link.click();
}
</script>

</body>
</html>
